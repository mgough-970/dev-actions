# Example workflow for running notebook CI on pull requests
# Copy this file to your repository's .github/workflows/ directory

name: Notebook CI - Pull Request

on:
  pull_request:
    branches: [ main, develop ]
    paths:
      - 'notebooks/**'
      - '*.yml'
      - '*.yaml'
      - 'requirements.txt'
      - 'pyproject.toml'

jobs:
  validate-notebooks:
    uses: mgrough-970/dev-actions/.github/workflows/ci_pipeline.yml@dev-actions-v2
    with:
      python-version: "3.11"
      execution-mode: "validation-only"
      build-html: false
      security-scan: true
    secrets:
      CASJOBS_USERID: ${{ secrets.CASJOBS_USERID }}
      CASJOBS_PW: ${{ secrets.CASJOBS_PW }}

  build-docs-preview:
    uses: mgrough-970/dev-actions/.github/workflows/ci_html_builder.yml@dev-actions-v2
    with:
      python-version: "3.11"
      post-run-script: "scripts/jdaviz_image_replacement.sh"  # Optional
    secrets:
      github-token: ${{ secrets.GITHUB_TOKEN }}
